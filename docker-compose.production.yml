# Docker Compose - Production Environment
# Usage: docker-compose -f docker-compose.yml -f docker-compose.production.yml up
#
# IMPORTANT: NEXT_PUBLIC_ variables must be passed as build args (not runtime env)
# They are inlined into the JavaScript bundle at build time.
#
# Example:
#   docker-compose -f docker-compose.yml -f docker-compose.production.yml build \
#     --build-arg NEXT_PUBLIC_API_URL=https://api.yourdomain.com

services:
  web:
    build:
      target: runner
      args:
        # These MUST be provided at build time
        NEXT_PUBLIC_API_URL: ${NEXT_PUBLIC_API_URL:-https://api.dashfinance.example.com}
        NEXT_PUBLIC_APP_NAME: ${NEXT_PUBLIC_APP_NAME:-Dash Finance}
        NEXT_PUBLIC_APP_VERSION: ${NEXT_PUBLIC_APP_VERSION:-0.1.0}
        NEXT_PUBLIC_ENABLE_DEBUG: ${NEXT_PUBLIC_ENABLE_DEBUG:-false}
        NEXT_PUBLIC_ENABLE_ANALYTICS: ${NEXT_PUBLIC_ENABLE_ANALYTICS:-true}
    environment:
      NODE_ENV: production
    volumes: []  # Remove dev volumes in production
    command: bun run apps/web/server.js
